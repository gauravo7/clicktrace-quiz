<div class="quiz-container">
  <div class="main-content">

     <!-- RIGHT SIDE: Questions List -->
    <div class="questions-list-section">
      <div class="section-header">
        <h2>Lived Questions</h2>
        <span class="badge">{{ !!liveData?1:0 }}</span>
      </div>

      <div class="questions-container" *ngIf="!!liveData">
        <div  class="accordion-item">
          <div class="accordion-header" (click)="toggleAccordion(liveData)">
            <div class="accordion-header-content">
              <!-- <div class="question-number">Q{{ q.id }}</div> -->
              <div class="question-preview">
                <div class="question-text">{{ liveData?.question }}</div>

                <div class="correct-answer">
                  <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="20 6 9 17 4 12"></polyline>
                  </svg>
                  {{ liveData?.options[liveData?.correctAnswer] }}
                </div>
              </div>
            </div>
            <div class="accordion-actions">
              <!-- Show image if available -->
              <div class="question-image " *ngIf="liveData?.image">
                <img class="avatar" [src]="liveData?.image" alt="Question Image" />
              </div>
              <svg class="expand-icon" [class.expanded]="liveData?.expanded" width="20" height="20" viewBox="0 0 24 24"
                fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="6 9 12 15 18 9"></polyline>
              </svg>
              <button class="delete-icon-btn" (click)="stopLive(liveData?.id); $event.stopPropagation()" *ngIf="liveData.isStart">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                  class="bi bi-slash-circle" viewBox="0 0 16 16">
                  <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16" />
                  <path d="M11.354 4.646a.5.5 0 0 0-.708 0l-6 6a.5.5 0 0 0 .708.708l6-6a.5.5 0 0 0 0-.708" />
                </svg>
              </button>
              <button class="live-icon-btn" (click)="showOptions(liveData?.id); $event.stopPropagation()" *ngIf="!liveData?.isStart">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-send"
                  viewBox="0 0 16 16">
                  <path
                    d="M15.854.146a.5.5 0 0 1 .11.54l-5.819 14.547a.75.75 0 0 1-1.329.124l-3.178-4.995L.643 7.184a.75.75 0 0 1 .124-1.33L15.314.037a.5.5 0 0 1 .54.11ZM6.636 10.07l2.761 4.338L14.13 2.576zm6.787-8.201L1.591 6.602l4.339 2.76z" />
                </svg>
              </button>
            </div>
          </div>

          <div class="accordion-content" [class.expanded]="liveData?.expanded">
            <div class="options-display">
              <div *ngFor="let opt of liveData?.options; let i = index" class="option-display-item"
                [class.correct]="i === liveData?.correctAnswer">
                <span class="option-letter">{{ (i+1)}}</span>
                <span class="option-text">{{ opt }}</span>
                <svg *ngIf="i === liveData?.correctAnswer" class="check-icon" width="16" height="16" viewBox="0 0 24 24"
                  fill="none" stroke="currentColor" stroke-width="3">
                  <polyline points="20 6 9 17 4 12"></polyline>
                </svg>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="empty-state py-1" *ngIf="!!liveData == false">
        <p class="py-0 my-0">No questions lived yet</p>
      </div>


      <hr class="my-4">
      <div class="section-header">
        <h2>Added Questions</h2>
        <span class="badge">{{ questionsList.length }}</span>
      </div>



      <div class="questions-container" *ngIf="questionsList.length > 0">
        <div *ngFor="let q of questionsList; trackBy: trackById" class="accordion-item">
          <div class="accordion-header" (click)="toggleAccordion(q)">
            <div class="accordion-header-content">
              <!-- <div class="question-number">Q{{ q.id }}</div> -->
              <div class="question-preview">
                <div class="question-text">{{ q.question }}</div>

                <div class="correct-answer">
                  <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="20 6 9 17 4 12"></polyline>
                  </svg>
                  {{ q.options[q.correctAnswer] }}
                </div>
              </div>
            </div>
            <div class="accordion-actions">
              <!-- Show image if available -->
              <div class="question-image " *ngIf="q.image">
                <img class="avatar" [src]="q.image" alt="Question Image" />
              </div>
              <svg class="expand-icon" [class.expanded]="q.expanded" width="20" height="20" viewBox="0 0 24 24"
                fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="6 9 12 15 18 9"></polyline>
              </svg>
              <button class="delete-icon-btn" (click)="stopLive(q.id); $event.stopPropagation()">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                  class="bi bi-slash-circle" viewBox="0 0 16 16">
                  <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16" />
                  <path d="M11.354 4.646a.5.5 0 0 0-.708 0l-6 6a.5.5 0 0 0 .708.708l6-6a.5.5 0 0 0 0-.708" />
                </svg>
              </button>
              <button class="live-icon-btn" (click)="live(q); $event.stopPropagation()">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-send"
                  viewBox="0 0 16 16">
                  <path
                    d="M15.854.146a.5.5 0 0 1 .11.54l-5.819 14.547a.75.75 0 0 1-1.329.124l-3.178-4.995L.643 7.184a.75.75 0 0 1 .124-1.33L15.314.037a.5.5 0 0 1 .54.11ZM6.636 10.07l2.761 4.338L14.13 2.576zm6.787-8.201L1.591 6.602l4.339 2.76z" />
                </svg>
              </button>
              <button class="delete-icon-btn" (click)="deleteQuestion(q.id); $event.stopPropagation()">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="3 6 5 6 21 6"></polyline>
                  <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                </svg>
              </button>
            </div>
          </div>

          <div class="accordion-content" [class.expanded]="q.expanded">
            <div class="options-display">
              <div *ngFor="let opt of q.options; let i = index" class="option-display-item"
                [class.correct]="i === q.correctAnswer">
                <span class="option-letter">{{ (i+1)}}</span>
                <span class="option-text">{{ opt }}</span>
                <svg *ngIf="i === q.correctAnswer" class="check-icon" width="16" height="16" viewBox="0 0 24 24"
                  fill="none" stroke="currentColor" stroke-width="3">
                  <polyline points="20 6 9 17 4 12"></polyline>
                </svg>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="empty-state" *ngIf="questionsList.length === 0">
        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <path d="M9 11l3 3L22 4"></path>
          <path d="M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11"></path>
        </svg>
        <p>No questions added yet</p>
      </div>
    </div>


    <!-- LEFT SIDE: Question Form -->
    <div class="form-section">
      <div class="question-section">
        <div class="section-header">
          <h2>Question</h2>
          <div class="action-buttons ">
            <button class="btn btn-secondary " (click)="resetForm()">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="1 4 1 10 7 10"></polyline>
                <polyline points="23 20 23 14 17 14"></polyline>
                <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"></path>
              </svg>
              Reset
            </button>
            <button class="btn btn-primary" (click)="submitQuestion()">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="9 11 12 14 22 4"></polyline>
                <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
              </svg>
              Add Question
            </button>
          </div>
        </div>
        <div class="input-wrapper">
          <label class="mb-2 mx-1 section-head">Add Question</label>
          <textarea [(ngModel)]="question" placeholder="Enter question here..." rows="4" required></textarea>
          <div class="input-wrapper image-upload">
            <!-- <label for="questionImage">Attach Image (optional)</label>
            <input type="file" id="questionImage" accept="image/*" (change)="onImageSelected($event)" /> -->

            <label class="mb-2 mx-1 section-head">Add Image (optional)</label>
            <div class="mb-3 d-flex gap-3">
              <label for="questionImage" class="upload-box w-50">
                <input type="file" id="questionImage" accept="image/*" (change)="onImageSelected($event)" hidden>
                <span>Upload<br><small>JPG or PNG</small></span>
              </label>

              @if(questionImage){<div class="image-preview">
                <img [src]="questionImage" alt="Question Image Preview" class="avatar"/>
                <button type="button" class="btn btn-sm btn-danger" (click)="removeImage()">Remove</button>
              </div>}
            </div>
          </div>

        </div>
      </div>

      <div class="options-section">
        <div class="section-header">
          <h2>Answer Options</h2>
          <span class="helper-text">Select the correct answer</span>
        </div>
        <div class="options-list">
          <div *ngFor="let option of options; let i = index; trackBy: trackByIndex" class="option-item">
            <div class="option-input-group">
              <input type="radio" name="correctOption" [value]="i" [(ngModel)]="correctOptionIndex" required />
              <input type="text" [(ngModel)]="options[i]" placeholder="Option {{ i + 1 }}" required />
            </div>
          </div>
        </div>
      </div>
    </div>


  </div>
</div>
